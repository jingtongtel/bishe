<?xml version="1.0" encoding="UTF-8" ?>   
<!DOCTYPE mapper   
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"   
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- mybatis操作student对象的配置文件，与mapper接口对应 -->
<mapper namespace="com.boco.human.v01.mapper.PopulationMapper">

    <!-- 全量查询，'id'须唯一，与mapper接口方法名保持一致 -->
	<select id="query"    parameterType="Map"  resultType="hashMap">
SELECT
	k.REGION_CODE regionCode,
	INFLOW_USER_SUM inflowUserSum,
	OUTFLOW_USER_SUM outflowUserSum,
	FIX_USER_SUM fixUserSum,
    STAY_CODE statCode,
   k.REGION_NAME regionName
FROM
      	<if test="tableName!=null and !tableName.equals('')">
		${tableName} q ,pub_dim_keyregion k
		</if>
WHERE  q.REGION_CODE=k.REGION_CODE
        <if test="regionType!=null and !regionType.equals('')">
		AND q.REGION_TYPE = #{regionType}
		</if>
		<if test="userType!=null and !userType.equals('')">
		AND USER_TYPE = #{userType}  
		</if>

        <if test="dateD!=null and !dateD.equals('')">
		AND DATE_D in
		<foreach item="item" index="index" collection="dateD" open="(" separator="," close=")">   
           #{item}   
 		</foreach>   
			 	
		</if>
		
		<if test="dateH!=null and !dateH.equals('')">
		AND DATE_H in
		<foreach item="item" index="index" collection="dateH" open="(" separator="," close=")">   
           #{item}   
 		</foreach>   
			 	
		</if>
		
		<if test="dateDH!=null and !dateDH.equals('')">
		AND DATE_DH in
		<foreach item="item" index="index" collection="dateDH" open="(" separator="," close=")">   
           #{item}   
 		</foreach>   
			 	
		</if>
		<if test="dateMIN!=null and !dateMIN.equals('')">
				AND DATE_MIN  in 
	    <foreach item="item" index="index" collection="dateMIN" open="(" separator="," close=")">   
           #{item}   
 		</foreach>   
		</if>
		<if test="dateM!=null and !dateM.equals('')">
		AND DATE_M in
		<foreach item="item" index="index" collection="dateM" open="(" separator="," close=")">   
           #{item}   
 		</foreach>   
			 	
		</if>
		<if test="dateW!=null and !dateW.equals('')">
		AND DATE_W in
		<foreach item="item" index="index" collection="dateW" open="(" separator="," close=")">   
           #{item}   
 		</foreach>   
			 	
		</if>
		
		<if test="dateQ!=null and !dateQ.equals('')">
		AND DATE_Q in
		<foreach item="item" index="index" collection="dateQ" open="(" separator="," close=")">   
           #{item}   
 		</foreach>   
			 	
		</if>
		<if test="dateY!=null and !dateY.equals('')">
		AND DATE_Y in
		<foreach item="item" index="index" collection="dateY" open="(" separator="," close=")">   
           #{item}   
 		</foreach>   
			 	
		</if>
		
		
			
	</select>
</mapper>